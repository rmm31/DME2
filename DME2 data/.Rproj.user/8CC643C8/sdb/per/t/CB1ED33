{
    "collab_server" : "",
    "contents" : "library(tidyverse)\n\n# Make a tibble\n\nqldgen <- as.tibble(Book1)\n\n#Remove unnecessary rows and columns\n\nqldgen <- select(qldgen, Status:Other)\nqldgen <- filter(qldgen, Status %in% c(\"Announced Withdrawal\", \"Existing less Announced Withdrawal\", \"Committed\", \"Proposed\"))\n\n#Create a variable that combines all gas\nqldgen3 <- mutate(qldgen, `All gas` = CCGT + OCGT + `Gas other`)\n\n#reshape to gather into variables\n\nqldgen4 <- qldgen3 %>% gather(\"Coal\", \"CCGT\", \"OCGT\", \"Gas other\", \"Solar*\", \"Wind\", \"Water\", \"Biomass\", \"Storage\", \"Other\", \"All gas\", key = \"Energy_Source\", value = \"MW_Capacity\")\n\n#Add solar data (calculated below)\n\nQLD_rooftop$Status1 <- QLD_rooftop$Status\nQLD_rooftop_forecast$Status1 <- QLD_rooftop_forecast$Status\nqldgen5 <- rbind(qldgen4, QLD_rooftop, QLD_rooftop_forecast)\n\n#Change factor levels to change chart order (qldgen2 created below by adding rooftop solar figures from CER)\n\nqldgen5$Status1 <- factor(qldgen5$Status, levels = c('Forecast to 2028', 'Proposed', 'Committed','Announced Withdrawal','Existing less Announced Withdrawal'))\n\n#Chart as stacked bar chart\n\nggplot(qldgen5, aes(Energy_Source, MW_Capacity)) +\n  geom_col(aes(fill = Status1)) +\n  scale_y_continuous(breaks = seq(0, 9000, by = 1000)) +\n  scale_x_discrete(limits = c(\"Coal\", \"All gas\", \"Solar*\", \"Solar (small-scale)\", \"Wind\", \"Water\", \"Biomass\", \"Storage\", \"Other\")) +\n  scale_fill_brewer(palette = \"Dark2\") +\n  theme_bw() +\n  labs(x = \"Technology\", y = \"Generation capacity (MW)\") +\n  theme_bw() +\n  theme(panel.grid.major.x = element_blank() ) +\n  theme(panel.grid.minor.x = element_blank()) +\n  theme(axis.text=element_text(size=12),axis.title=element_text(size=14,face=\"bold\")) +\n  theme(axis.text.x=element_text(angle=45, hjust=1)) +\n  theme(legend.text = element_text(size = 12), legend.title = element_text(size = 14, face = \"bold\")) +\n  ggtitle(\"Queensland existing and potential new developments by generation type (MW)\") +\n  theme(plot.title = element_text(family = \"Trebuchet MS\", color=\"#666666\", face=\"bold\", size=16, hjust=0.5)) +\n  theme(legend.position=\"bottom\")\n\n#Clean Energy Regulator Data - small scale systems\n\nCER_data <- select(Postcode_data_for_small_scale_installations_SGU_Solar, \"Small Unit Installation Postcode\", \"Installations Quantity Total\", \"SGU Rated Output In kW Total\")\nCER_data <- as.tibble(CER_data)\n\n#Total installed small-scale solar QLD\nCER_data_QLD <- filter(CER_data, `Small Unit Installation Postcode` %in% c(4000:4999, 9000:9999))\nCER_data_QLD_total_kW <- summarise(CER_data_QLD, total = sum(`SGU Rated Output In kW Total`))\nCER_data_QLD_total_Installs <- summarise(CER_data_QLD, total = sum(`Installations Quantity Total`))\nCER_data_total_kW <- summarise(CER_data, total= sum(`SGU Rated Output In kW Total`)) \nCER_data_total_installs <- summarise(CER_data, total= sum(`Installations Quantity Total`)) \n\n#Recode whole table using Car package\ninstall.packages(\"car\")\nlibrary(car)\n\nCER_data$State <-recode(CER_data$`Small Unit Installation Postcode`, \"4000:4999='QLD'; 9000:9999 = 'QLD'; 1000:2999 = 'NSW'; 200:299 = 'NSW'; 3000:3999 = 'VIC'; 8000:8999 = 'VIC'; 5000:5999 = 'SA'; 6000:6999 = 'WA'; 800:999 = 'NT'; 7000:7999 = 'TAS'\")\n\n#Add new row for dataframe\n#Note that the forecast to 2028 for small-scale solar comes from Jacobs, Projections of uptake of small-scale systems for the Austrailan Energy Market Operator, Final Report (2016), Jacobs projections include integrated PV and Storage System uptake.\n\nQLD_rooftop <- data.frame(Status = \"Existing less Announced Withdrawal\", Energy_Source = \"Solar (small-scale)\", MW_Capacity = 1948)\nQLD_rooftop_forecast <- data.frame(Status = \"Forecast to 2028\", Energy_Source = \"Solar (small-scale)\", MW_Capacity = 2552)\nQLD_rooftop <- as.tibble(QLD_roofop)\nQLD_rooftop_forecast <- as.tibble(QLD_rooftop_forecast)\nqldgen2 <- rbind(qldgen1, QLD_rooftop, QLD_rooftop_forecast)\n\n\n\n\n#AEMO max demand chart code\n\nAEMO_forecast_max_demand <- as.tibble(AEMO_forecast_max_demand)\nAEMO_forecast_max_demand1 <- gather(AEMO_forecast_max_demand, \"Neutral\", \"Strong\", \"Weak\", key = \"Scenario\", value = \"Maximum demand (MW)\")\n\nggplot(AEMO_forecast_max_demand1, aes(Year, `Maximum demand (MW)`)) + \n  geom_line(aes(colour = Scenario)) +\n  expand_limits(y = 0) +\n  scale_y_continuous(breaks = seq(0, 12000, by = 2000)) +\n  scale_colour_manual(values=c(Neutral = \"blue\", Strong = \"red\", Weak = \"green\"))+\n  theme_bw() +\n  theme(panel.grid.minor.x = element_blank()) +\n  theme(axis.text=element_text(size=20),axis.title=element_text(size=24,face=\"bold\")) +\n  theme(legend.text = element_text(size = 20), legend.title = element_text(size = 24, face = \"bold\")) \n\n#AER Generation in Queensland over time\nAER_gen_region <- rename(AER_gen_region, c(\"X__1\" = \"Technology\"))\nAER_gen_region1 <- gather(AER_gen_region, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, key = \"Year\", value = \"TWh\")\nAER_gen_region1 <- as.tibble(AER_gen_region1)\nAER_gen_region1$Year <- as.numeric((AER_gen_region1$Year))\nAER_gen_region1 <- filter(AER_gen_region1, Technology != \"Brown coal\")\n\n#Change factor levels to change chart order\nAER_gen_region1$Technology2 <- factor(AER_gen_region1$Technology, levels = c('Rooftop solar', 'Solar farm', 'Wind', 'Hydro', 'Other dispatched', 'Gas', 'Black coal'))\n\n#Chart\nggplot(AER_gen_region1, aes(Year, TWh)) +\n  geom_area(aes(fill = Technology2)) +\n  scale_y_continuous(breaks = seq(0, 60, by = 10)) +\n  #expand_limits(x = 2030) +\n  scale_x_continuous(breaks = seq(2005, 2030, by = 1)) +\n  theme_bw() +\n  theme(axis.text.x=element_text(angle=45, hjust=1)) +\n  theme(axis.text=element_text(size=20),axis.title=element_text(size=24,face=\"bold\")) +\n  theme(legend.text = element_text(size = 20), legend.title = element_text(size = 24, face = \"bold\")) +\n  #theme(legend.position=\"bottom\") +\n  theme(panel.grid.minor.x = element_blank()) \n",
    "created" : 1517354794809.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3402440329",
    "id" : "CB1ED33",
    "lastKnownWriteTime" : 1518084833,
    "last_content_update" : 1518084833097,
    "path" : "~/Documents/GitHub/QLD DMEE/DMEE data/Code for analysis and charts.R",
    "project_path" : "Code for analysis and charts.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}